<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰¬å·å¸‚ç”Ÿæ€ç©ºé—´ä¿æŠ¤åŒºåŸŸ</title>
    <!-- cdnæ–¹å¼å¼•å…¥cesium -->
    <script src="./cesium/Build/Cesium/Cesium.js"></script>
    <link href="./cesium/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
</head>

</head>
<style>
    html,
    body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
    }

    #cesiumContainer {
        height: 100%;
    }

    #home {
        display: flex;
        justify-content: center;
        align-items: center;
        position: fixed;
        left: 10px;
        top: 10px;
        width: 30px;
        height: 30px;
        background-color: #fff;
        z-index: 999;
        user-select: none;
        cursor: pointer;
    }

    #gkq {
        display: flex;
        justify-content: center;
        align-items: center;
        position: fixed;
        left: 50px;
        top: 10px;
        width: 30px;
        height: 30px;
        background-color: #fff;
        z-index: 999;
        user-select: none;
        cursor: pointer;
    }

    #hx {
        display: flex;
        justify-content: center;
        align-items: center;
        position: fixed;
        left: 90px;
        top: 10px;
        width: 30px;
        height: 30px;
        background-color: #fff;
        z-index: 999;
        user-select: none;
        cursor: pointer;
    }

    #dyh {
        display: flex;
        justify-content: center;
        align-items: center;
        position: fixed;
        left: 130px;
        top: 10px;
        width: 30px;
        height: 30px;
        background-color: #fff;
        z-index: 999;
        user-select: none;
        cursor: pointer;
    }
</style>

<body>
    <div id="cesiumContainer"></div>
    <div id="home">ğŸ </div>
    <div id="gkq">ç®¡</div>
    <div id="hx">çº¢</div>
    <div id="dyh">è¿</div>

    <script>
        Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIwYzljYzAwNi03MDM2LTRkNzAtOTU5MS1lMDk4ZDc4YjQyZTMiLCJpZCI6Mzc4NzAsImlhdCI6MTYwNTY2MjY1MH0.A7BBr5K2nZNRjJls6uFc5elvf5FMFWJuD6dozwLw5vY';

        let options = {
            geocoder: false,   // ä½ç½®æŸ¥æ‰¾å·¥å…·
            homeButton: false,  // è§†è§’è¿”å›åˆå§‹ä½ç½®
            sceneModePicker: false,   // é€‰æ‹©è§†è§’çš„æ¨¡å¼ï¼ˆçƒä½“ã€å¹³é“ºã€æ–œè§†å¹³é“ºï¼‰
            baseLayerPicker: false,    // å›¾å±‚é€‰æ‹©å™¨ï¼ˆåœ°å½¢å½±åƒæœåŠ¡ï¼‰
            navigationHelpButton: false,   // å¯¼èˆªå¸®åŠ©
            animation: false,   // å·¦ä¸‹è§’ä»ªè¡¨ç›˜
            timeline: false,   // åº•éƒ¨æ—¶é—´çº¿
            fullscreenButton: false,   // å…¨å±
            infoBox: true,     //å•å‡»ä¿¡æ¯æ¡†
            vrButton: false,  // VR
            sceneMode: Cesium.SceneMode.SCENE2D
            // terrainProvider: Cesium.createWorldTerrain()    //å¼€å¯ä¸‰ç»´åœ°å½¢
        };

        const viewer = new Cesium.Viewer('cesiumContainer', options);
        //å»é™¤ç‰ˆæƒä¿¡æ¯
        viewer.cesiumWidget.creditContainer.style.display = "none";
        // æŠ—é”¯é½¿
        viewer.scene.postProcessStages.fxaa.enabled = false;

        // å¤©åœ°å›¾å½±åƒ
        const tdtKey = '9145d3e317885a34666e5beb1fcacf71';
        viewer.imageryLayers.addImageryProvider(new Cesium.WebMapTileServiceImageryProvider({
            url: "https://t0.tianditu.gov.cn/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=" + tdtKey,
            layer: "tdtBasicLayer",
            style: "default",
            format: "image/jpeg",
            tileMatrixSetID: "GoogleMapsCompatible",
            maximumLevel: 18,
        }));

        // å¤©åœ°å›¾å½±åƒæ³¨è®°
        viewer.imageryLayers.add(new Cesium.ImageryLayer(new Cesium.WebMapTileServiceImageryProvider({
            url: "https://t0.tianditu.gov.cn/cia_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=" + tdtKey,
            layer: "tdtBasicLayer",
            style: "default",
            format: "image/jpeg",
            tileMatrixSetID: "GoogleMapsCompatible",
            maximumLevel: 18,
        })));

        //å°†åˆå§‹è§†è§’å®šåˆ°æ‰¬å·
        back();

        // ç®¡æ§åŒº
        const option = {
            camera: viewer.scene.camera,
            canvas: viewer.scene.canvas,
            clampToGround: true,
        }

        const gkqUrl = './data/ç”Ÿæ€ç©ºé—´ç®¡æ§åŒº.kml';
        let gkq; let gkqVisible = false;
        Cesium.KmlDataSource.load(gkqUrl, option).then(function (dataSource) {
            var entities = dataSource.entities.values;
            for (var i = 0; i < entities.length; i++) {
                var entity = entities[i];
                if (entity.polygon) {
                    entity.polygon.material = Cesium.Color.YELLOW.withAlpha(0.4);
                    entity.polygon.heightReference = Cesium.HeightReference.RELATIVE_TO_GROUND;
                }
            }
            viewer.dataSources.add(dataSource);
            gkq = dataSource;
            gkqVisible = true;
        });

        // çº¢çº¿
        const byhx = './data/å®åº”çº¢çº¿.kml';
        const gyhx = './data/é«˜é‚®çº¢çº¿.kml';
        const glhx = './data/å¹¿é™µçº¢çº¿.kml';
        const hjhx = './data/é‚—æ±Ÿçº¢çº¿.kml';
        const jdhx = './data/æ±Ÿéƒ½çº¢çº¿.kml';
        const jjkfqhx = './data/ç»æµå¼€å‘åŒºçº¢çº¿.kml';
        const yzhx = './data/ä»ªå¾çº¢çº¿.kml';
        const hxs = [byhx, gyhx, glhx, hjhx, jdhx, jjkfqhx, yzhx];

        let hx = []; let hxVisible = false;
        for (let i = 0; i < 7; i++) {
            Cesium.KmlDataSource.load(hxs[i], option).then(function (dataSource) {
                var entities = dataSource.entities.values;
                for (var i = 0; i < entities.length; i++) {
                    var entity = entities[i];
                    if (entity.polygon) {
                        entity.polygon.material = Cesium.Color.RED.withAlpha(0.4);
                        entity.polygon.heightReference = Cesium.HeightReference.RELATIVE_TO_GROUND;
                    }
                }
                viewer.dataSources.add(dataSource);
                hx.push(dataSource);
                hxVisible = true;
            });
        }

        // å¤§è¿æ²³æ ¸å¿ƒç›‘æ§åŒº
        const dyhUrl = './data/å¤§è¿æ²³æ ¸å¿ƒç›‘æ§åŒº.kml';
        let dyh; let dyhVisible = false;
        Cesium.KmlDataSource.load(dyhUrl, option).then(function (dataSource) {
            var entities = dataSource.entities.values;
            for (var i = 0; i < entities.length; i++) {
                var entity = entities[i];
                if (entity.polygon) {
                    entity.polygon.material = Cesium.Color.GREEN.withAlpha(0.4);
                    entity.polygon.heightReference = Cesium.HeightReference.RELATIVE_TO_GROUND;
                }
            }
            viewer.dataSources.add(dataSource);
            dyh = dataSource;
            dyhVisible = true;
        });



        document.getElementById('home').addEventListener('click', () => back());

        function back() {
            viewer.camera.setView({ destination: Cesium.Cartesian3.fromDegrees(119.421003, 32.393159, 100000) });

        }

        // æ§åˆ¶ç®¡æ§åŒºæ˜¾ç¤º
        document.getElementById('gkq').addEventListener('click', () => {
            if (gkqVisible) {
                viewer.dataSources.remove(gkq);
                gkqVisible = false;
                return;
            }
            if (!gkqVisible) {
                viewer.dataSources.add(gkq);
                gkqVisible = true;
                return;
            }
        });

        // æ§åˆ¶çº¢çº¿æ˜¾ç¤º
        document.getElementById('hx').addEventListener('click', () => {

            if (hxVisible) {
                for (let i = 0; i < 7; i++) {
                    viewer.dataSources.remove(hx[i]);
                }
                hxVisible = false;
                return;
            }
            if (!hxVisible) {
                for (let i = 0; i < 7; i++) {
                    viewer.dataSources.add(hx[i]);
                }
                hxVisible = true;
                return;
            }
        });

        // æ§åˆ¶å¤§è¿æ²³æ˜¾ç¤º
        document.getElementById('dyh').addEventListener('click', () => {

            if (dyhVisible) {
                viewer.dataSources.remove(dyh);
                dyhVisible = false;
                return;
            }
            if (!dyhVisible) {
                viewer.dataSources.add(dyh);
                dyhVisible = true;
                return;
            }
        });



    </script>
</body>

</html>