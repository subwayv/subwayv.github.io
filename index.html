<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>扬州市生态空间保护区域</title>
    <!-- cdn方式引入cesium -->
    <script src="./cesium/Build/Cesium/Cesium.js"></script>
    <link href="./cesium/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
</head>

</head>
<style>
    /* 处理浏览器侧边距、滚动条 */
    html,
    body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;

    }

    /* cesium容器全屏 */
    #cesiumContainer {

        height: 100%;
    }
</style>

<body>
    <!-- cesium容器 -->
    <div id="cesiumContainer"></div>
    <script>
        Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIwYzljYzAwNi03MDM2LTRkNzAtOTU5MS1lMDk4ZDc4YjQyZTMiLCJpZCI6Mzc4NzAsImlhdCI6MTYwNTY2MjY1MH0.A7BBr5K2nZNRjJls6uFc5elvf5FMFWJuD6dozwLw5vY';
        //cesium设置项
        let options = {
            geocoder: false,   // 位置查找工具
            homeButton: false,  // 视角返回初始位置
            sceneModePicker: false,   // 选择视角的模式（球体、平铺、斜视平铺）
            baseLayerPicker: false,    // 图层选择器（地形影像服务）
            navigationHelpButton: false,   // 导航帮助
            animation: false,   // 左下角仪表盘
            timeline: false,   // 底部时间线
            fullscreenButton: false,   // 全屏
            infoBox: true,     //单击信息框
            vrButton: false,  // VR
            sceneMode: Cesium.SceneMode.SCENE2D
            // terrainProvider: Cesium.createWorldTerrain()    //开启三维地形
        };
        //构建cesium基础应用
        const viewer = new Cesium.Viewer('cesiumContainer', options);
        //开启光照效果
        viewer.scene.globe.enableLighting = false;
        //去除版权信息
        viewer.cesiumWidget.creditContainer.style.display = "none";

        let webKey = '9145d3e317885a34666e5beb1fcacf71';
        viewer.imageryLayers.addImageryProvider(new Cesium.WebMapTileServiceImageryProvider({
            url: "https://t0.tianditu.gov.cn/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=" + webKey,
            layer: "tdtBasicLayer",
            style: "default",
            format: "image/jpeg",
            tileMatrixSetID: "GoogleMapsCompatible",
            show: false
        }));


        //将初始视角定到中国
        viewer.camera.setView({
            destination: Cesium.Cartesian3.fromDegrees(119.421003, 32.393159, 2000),
            orientation: {
                heading: Cesium.Math.toRadians(348.4202942851978),
                pitch: Cesium.Math.toRadians(-89.74026687972041),
                roll: Cesium.Math.toRadians(0)
            },
        });


        // 管控区
        const option = {
            camera: viewer.scene.camera,
            canvas: viewer.scene.canvas,
            clampToGround: true,
        }

        const gkqUrl = './生态空间管控区.kml';
        Cesium.KmlDataSource.load(gkqUrl, option).then(function (dataSource) {
            var entities = dataSource.entities.values;
            for (var i = 0; i < entities.length; i++) {
                var entity = entities[i];
                if (entity.polygon) {
                    entity.polygon.material = Cesium.Color.YELLOW.withAlpha(0.25);
                    entity.polygon.heightReference = Cesium.HeightReference.RELATIVE_TO_GROUND;
                }
            }
            viewer.dataSources.add(dataSource);
        });

        // 红线
        const byhx = './宝应红线.kml';
        const gyhx = './高邮红线.kml';
        const glhx = './广陵红线.kml';
        const hjhx = './邗江红线.kml';
        const jdhx = './江都红线.kml';
        const jjkfqhx = './经济开发区红线.kml';
        const yzhx = './仪征红线.kml';
        const hx = [byhx, gyhx, glhx, hjhx, jdhx, jjkfqhx, yzhx];

        for (let i = 0; i < 7; i++) {
            Cesium.KmlDataSource.load(hx[i], option).then(function (dataSource) {
                var entities = dataSource.entities.values;
                for (var i = 0; i < entities.length; i++) {
                    var entity = entities[i];
                    if (entity.polygon) {
                        entity.polygon.material = Cesium.Color.RED.withAlpha(0.25);
                        entity.polygon.heightReference = Cesium.HeightReference.RELATIVE_TO_GROUND;
                    }
                }
                viewer.dataSources.add(dataSource);
            });
        }

        // 大运河核心监控区
        const dyhUrl = './大运河核心监控区.kml';
        Cesium.KmlDataSource.load(dyhUrl, option).then(function (dataSource) {
            var entities = dataSource.entities.values;
            for (var i = 0; i < entities.length; i++) {
                var entity = entities[i];
                if (entity.polygon) {
                    entity.polygon.material = Cesium.Color.GREEN.withAlpha(0.25);
                    entity.polygon.heightReference = Cesium.HeightReference.RELATIVE_TO_GROUND;
                }
            }
            viewer.dataSources.add(dataSource);
        });







    </script>
</body>

</html>